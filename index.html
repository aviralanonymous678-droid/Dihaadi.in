<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dihaadi.in - Register</title>
<style>
  body {
    font-family: "Poppins", Arial, sans-serif;
    background: linear-gradient(135deg, #ffe4e6, #ffcad4);
    color: #6b0214;
    margin: 0;
    padding: 0;
  }
  header {
    background: #ff6384;
    color: white;
    padding: 2rem 1rem;
    text-align: center;
  }
  .language-toggle {
    text-align: right;
    margin: 0.5rem 1rem;
  }
  .language-toggle button {
    background-color: #6b0214;
    color: #ffc1cc;
    border: none;
    margin: 0 5px;
    padding: 0.4rem 0.8rem;
    cursor: pointer;
    border-radius: 5px;
  }
  .container {
    max-width: 960px;
    margin: 2rem auto;
    background-color: #ffe4e6dd;
    border-radius: 8px;
    box-shadow: 0 0 30px #ff7f91aa;
    padding: 2rem;
  }
  .hero img {
    width: 100%;
    border-radius: 8px;
  }
  h2 {
    color: #bf1650;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
  }
  input, select, button {
    width: 100%;
    max-width: 400px;
    padding: 10px;
    margin: 0.5rem 0 1rem 0;
    border-radius: 8px;
    border: 1px solid #bf1650;
    font-size: 1rem;
  }
  input, select {
    background-color: #fff0f4;
    color: #6b0214;
  }
  button {
    background-color: #bf1650;
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background-color: #9b1440;
  }
  footer {
    background-color: #6b0214;
    color: #ffc1cc;
    text-align: center;
    padding: 1rem;
    margin-top: 2rem;
  }
</style>
</head>
<body>

<div class="language-toggle">
  <button onclick="setLanguage('en')">English</button>
  <button onclick="setLanguage('hi')">हिंदी</button>
</div>

<header>
  <h1 id="title">Welcome to Dihaadi.in</h1>
  <p id="subtitle">Connecting Daily Wage Workers and Contractors</p>
</header>

<div class="container">
  <div class="hero">
    <img src="https://images.unsplash.com/photo-1603389658852-294f5f8586d4?auto=format&fit=crop&w=1600&q=80" alt="Indian labourers working together" />
  </div>

  <h2 id="registerTitle">Register as Labour / Contractor</h2>
  <form id="registerForm">
    <label id="roleLabel" for="role">I am a:</label>
    <select id="role" name="role" required>
      <option value="">Select Role</option>
      <option value="labour">मज़दूर</option>
      <option value="contractor">कॉन्ट्रैक्टर</option>
    </select>

    <label id="nameLabel" for="name">Full Name:</label>
    <input id="name" name="name" type="text" required />

    <label id="aadhaarLabel" for="aadhaar">Aadhaar Number:</label>
    <input id="aadhaar" name="aadhaar" type="text" pattern="[0-9]{12}" title="12 digit number" required />

    <label id="mobileLabel" for="mobile">Mobile Number:</label>
    <input id="mobile" name="mobile" type="tel" pattern="[0-9]{10}" title="10 digit mobile number" required />

    <label id="skillsLabel" for="skills">Skill Category (for labour):</label>
    <select id="skills" name="skills">
      <option value="">Select Skill</option>
      <option value="mason">राज मिस्त्री</option>
      <option value="carpenter">बढ़ई</option>
      <option value="electrician">बिजली मिस्त्री</option>
      <option value="plumber">नलकार</option>
      <option value="painter">रंगाई पुताई</option>
      <option value="welder">वेल्डर</option>
      <option value="ironworker">लोहे का काम</option>
      <option value="tile_setter">टाइल लगाने वाला</option>
      <option value="driver">वाहन चालक</option>
      <option value="cleaner">सफाई कर्मचारी</option>
      <option value="helper">सहायक</option>
      <option value="machine_operator">मशीन चलाने वाला</option>
      <option value="gardener">माली</option>
      <option value="supervisor">साइट पर्यवेक्षक</option>
      <option value="other">अन्य</option>
    </select>

    <label id="availabilityLabel" for="availability">Availability:</label>
    <input id="availability" name="availability" type="text" placeholder="Days and Timings" />

    <button type="submit" id="registerBtn">Register</button>
  </form>
</div>

<footer>
  <p>© Dihaadi.in 2025 | Empowering Workers, Building Futures</p>
</footer>

<script>
  const translations = {
    hi: {
      title: "स्वागत है Dihaadi.in में",
      subtitle: "दैनिक मज़दूरों और कॉन्ट्रैक्टरों को जोड़ने वाला मंच",
      registerTitle: "मज़दूर / कॉन्ट्रैक्टर के रूप में पंजीकरण करें",
      roleLabel: "मैं हूँ:",
      nameLabel: "पूरा नाम:",
      aadhaarLabel: "आधार नंबर:",
      mobileLabel: "मोबाइल नंबर:",
      skillsLabel: "कौशल श्रेणी (मज़दूरों के लिए):",
      availabilityLabel: "उपलब्धता:",
      registerBtn: "पंजीकरण करें"
    },
    en: {
      title: "Welcome to Dihaadi.in",
      subtitle: "Connecting Daily Wage Workers and Contractors",
      registerTitle: "Register as Labour / Contractor",
      roleLabel: "I am a:",
      nameLabel: "Full Name:",
      aadhaarLabel: "Aadhaar Number:",
      mobileLabel: "Mobile Number:",
      skillsLabel: "Skill Category (for labour):",
      availabilityLabel: "Availability:",
      registerBtn: "Register"
    }
  };

  function setLanguage(lang) {
    const t = translations[lang];
    for (const key in t) {
      document.getElementById(key).innerText = t[key];
    }
  }

  document.getElementById('registerForm').addEventListener('submit', async function(e) {
    e.preventDefault();  // IMPORTANT: Prevent the default form submission

    const data = {
      role: document.getElementById('role').value,
      name: document.getElementById('name').value,
      aadhaar: document.getElementById('aadhaar').value,
      mobile: document.getElementById('mobile').value,
      skills: document.getElementById('skills').value,
      availability: document.getElementById('availability').value,
    };

    try {
      const response = await fetch('http://127.0.0.1:5000/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });

      if (!response.ok) {
        throw new Error('Server error: ' + response.status);
      }

      const result = await response.json();
      alert(result.message);
      // Optionally clear the form or show success UI here
      document.getElementById('registerForm').reset();

    } catch (error) {
      alert('Failed to submit registration: ' + error.message);
    }
  });
</script>
</body>
</html>
